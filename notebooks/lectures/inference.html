<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="We have introduced generative functions in Julia, as well as related them to probability theory. So far, however, we have only looked at sampling in the forward direction—from the joint. However, the fundamental reason that these tools are useful is that they can be used in the reverse direction—making inferences about unseen parts of our model based on observed information. In simulation-based approaches to probabilistic modeling, this is accomplished via conditioning our models on the values of particular outcomes of random variables. Most of the rest of the course will be devoted to understanding how to efficiently approximate conditional probability distriibutions." property="og:description"><meta content="Inference" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  @media print {
      h1 { @apply text-2xl !important; }
      h2 { @apply text-xl !important; }
      h3 { @apply text-lg !important; }
  }

  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
  table img { @apply inline-block; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.markdown-viewer ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.markdown-viewer .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.code-viewer {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.code-listing  {
    @apply -ml-8 -mr-8 relative !important;
}
.code-viewer .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
    .notebook-viewer .code-viewer .cm-content {
        @apply pl-12;
    }
    .notebook-viewer .code-listing {
        width: 48rem !important;
        @apply -ml-12 mr-0 !important;
    }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .result-viewer {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.notebook-viewer,
.markdown-viewer {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.markdown-viewer blockquote p:first-of-type:before,
.markdown-viewer blockquote p:last-of-type:after {
  @apply content-none;
}
.markdown-node-viewer.result-viewer.fragment-item {
    @apply mb-0 !important;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.markdown-viewer .toc      { @apply mt-4; }
.markdown-viewer h1 + .toc { @apply mt-8; }

.markdown-viewer .toc h1,
.markdown-viewer .toc h2,
.markdown-viewer .toc h3,
.markdown-viewer .toc h4,
.markdown-viewer .toc h5,
.markdown-viewer .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.markdown-viewer .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.markdown-viewer .toc li    { @apply m-0; }
.markdown-viewer .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.markdown-viewer *:first-child:not(.code-viewer):not(li):not(h2):not(.sidenote) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .result-viewer { @apply mt-0; }
.code-viewer + .result-viewer { @apply mt-3; }
.markdown-viewer + .markdown-viewer { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
}
.sidenote {
  @apply block font-sans text-xs mt-4 bg-slate-100 dark:bg-slate-800 p-4;
  font-style: normal;
  font-weight: normal;
}
.sidenote-container {
  @apply mb-4;
}
@media (min-width: 860px) {
  .sidenote sup { @apply inline; }
  .sidenote-column {
    @apply w-[165px] absolute right-0 top-0 -mr-[205px];
  }
  .sidenote {
    @apply bg-transparent dark:bg-transparent p-0;
  }
  .sidenote:first-child {
    @apply mt-1;
  }
  .sidenotes-layout .markdown-viewer {
    @apply pr-[241px];
  }
  .sidenote-container {
    @apply relative mb-0;
  }
  .sidenotes-layout h1 {
    @apply w-[756px] !important;
  }
}
.code-viewer + .viewer:not(.code-viewer):not(.code-viewer-folded),
.code-viewer-folded + .viewer:not(.code-viewer):not(.code-viewer-folded),
.result-viewer:not(.markdown-node-viewer) + .result-viewer {
  @apply mt-2;
}
.code-viewer + .code-viewer-folded {
  @apply mt-4;
}
.result-viewer {
  @apply leading-tight mb-6;
}
.code-viewer.fragment-item.result-viewer {
  @apply mb-0 !important;
}
.result-viewer figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }

@media print {
    .dark-mode-toggle,
    .toc-toggle { @apply hidden; }
    .notebook-viewer { @apply pt-0; font-size: 12pt !important; margin-left: 0 !important; }
    .code-viewer .cm-content,
    .viewer-code .cm-content { @apply whitespace-pre-wrap !important; overflow: none; }
    .code-viewer .cm-line { font-size: 12pt !important; }
    html * { page-break-inside: avoid !important; }
    .toc-panel { @apply hidden; }
}
</style><script src="https://cas.clerk.garden/tree/8VxCcd2nQqrhPLVttyyM5Rnv8qMYcjeSEjgJnhZTvCgVhmgsNWWeusxmVkfX9ajrXmFqQEdVmtdHSoCdHLG2XTsXXB/.clerk/shadow-cljs/main.js" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body class="dark:bg-gray-900"><div id="clerk"></div><script type="module">let viewer = nextjournal.clerk.sci_env
let state = "{:bundle? false, :path->doc {\"notebooks/lectures/inference.clj\" {:path [], :nextjournal/value {:toc [{:title \"Inference\", :emoji nil, :path \"#inference\", :items []} {:title \"Latent and Observed Random Variables\", :emoji nil, :path \"#latent-and-observed-random-variables\", :items []} {:title \"Inference Problems\", :emoji nil, :path \"#inference-problems\", :items []} {:title \"Inference via Conditioning\", :emoji nil, :path \"#inference-via-conditioning\", :items []}], :sidenotes? false, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns user), :file \"notebooks/lectures/inference.clj\", :bundle? false, :header {:path [], :nextjournal/value [:div.viewer.w-full.max-w-prose.px-8.not-prose.mt-3 [:div.mb-8.text-xs.sans-serif.text-slate-400 nil [:<> [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href \"./../../\"} \"Index\"] [:span.mx-2 \"•\"]] [:span \"Generated with \" [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href \"https://clerk.vision\"} \"Clerk\"] \" from \" [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href \"https://github.com/sritchie/tim-class/blob/573ebd011b9e427199a1f35ba3858ca43f9b7243/notebooks/lectures/inference.clj\"} \"notebooks/lectures/inference.clj\" [:<> \"@\" [:span.tabular-nums \"573ebd0\"]]]]]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}, :open-graph {:type \"article:clerk\", :title \"Inference\", :description \"We have introduced generative functions in Julia, as well as related them to probability theory. So far, however, we have only looked at sampling in the forward direction—from the joint. However, the fundamental reason that these tools are useful is that they can be used in the reverse direction—making inferences about unseen parts of our model based on observed information. In simulation-based approaches to probabilistic modeling, this is accomplished via conditioning our models on the values of particular outcomes of random variables. Most of the rest of the course will be devoted to understanding how to efficiently approximate conditional probability distriibutions.\"}, :title \"Inference\", :blocks [{:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"user/markdown-5du1pzfHiHgmykaf44fkzv7SJitixh\"} [\"h1\" {:id \"inference\"} [:<> \"Inference\"]] [:p [:<> \"We have introduced generative functions in Julia, as well as related them to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"probability theory. So far, however, we have only looked at sampling in the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"forward direction—from the joint. However, the fundamental reason that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"these tools are useful is that they can be used in the \"] [:em [:<> \"reverse\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"direction—making inferences about unseen parts of our model based on\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"observed information. In simulation-based approaches to probabilistic\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"modeling, this is accomplished via \"] [:em [:<> \"conditioning\"]] [:<> \" our models on the values of\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"particular outcomes of random variables. Most of the rest of the course will\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"be devoted to understanding how to efficiently approximate conditional\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"probability distriibutions.\"]] [:p [:<> \"In a Bayesian setting we use the term \"] [:em [:<> \"inference\"]] [:<> \" to refer to a kind of\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"hypothetical reason—implemented using conditional probabilities.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"Typically, this kind of reasoning asks for likely values of some unobserved\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"random variables in the model given some particular values of some \"] [:em [:<> \"observed\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"random variables.\"]] [:p [:<> \"Let's begin by introducing a few example inference problems to work with.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.code-viewer.code-listing [#viewer-eval nextjournal.clerk.render/inspect-presented {:path [0], :nextjournal/value \"using Gen\\nusing Plots\", :nextjournal/render-opts {:language \"julia\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [\"h1\" {:id \"latent-and-observed-random-variables\"} [:<> \"Latent and Observed Random Variables\"]] [:p [:<> \"Consider this variant of our biased coin model.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.code-viewer.code-listing [#viewer-eval nextjournal.clerk.render/inspect-presented {:path [0], :nextjournal/value \"@gen function flip_biased_coin(N)\\n    θ  ~ beta(1,1)\\n\\n    [{:x => i} ~ bernoulli(θ)  for i in 1:N]\\nend;\\n\\nt=Gen.simulate(flip_biased_coin,(5,))\\nGen.get_choices(t)\", :nextjournal/render-opts {:language \"julia\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:p [:<> \"When we are using probabilistic models, we make a distinction between\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:em [:<> \"latent\"]] [:<> \" and \"] [:em [:<> \"observed\"]] [:<> \" random variables. The observed random variables are\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"those variables which represent place holders for datapoints in our model. In\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the biased coin model, we generate \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" observed coin flips. The random\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"variables \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_i\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" representing these \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" coin flips constitute our observed\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"random variables. It is important to be careful here: The observed RV is the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"placeholder, not a particular observed value that we see in some specific\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"dataset. \"] [:em [:<> \"Latent\"]] [:<> \" random variables (also called \"] [:em [:<> \"hidden random variables\"]] [:<> \")\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"are those random variables who value must have been sampled in order to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"generate our data, but whose value we don't think of as available in our\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"data. In the biased coin model, the single latent random variable is\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [:p [:<> \"Note that which variables in a model are considered as observed and latent is\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"a matter of application and can change for different datasets for the same\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"model. The observed variables are just those variables for which you have\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"values available in that particular application.\"]] [:blockquote [:p [:<> \"What's an example of a scenario where for one application an RV might be observed and for another it might be latent?\"]]] [:p [:<> \"The distinction between observed and latent random variables allows us to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"formulate a precise, general meaning of the word \"] [:em [:<> \"inference\"]] [:<> \" in a Bayesian\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"setting: Inference is reasoning about possible values for the latent random\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"variables from particular values for the observed random variables.\"]] [\"h1\" {:id \"inference-problems\"} [:<> \"Inference Problems\"]] [:p [:<> \"In our biased coin flipping model, we return just the values of the \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" coin\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"flips. However, \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is unobserved. Thus a natural inference problem is\"]] [:blockquote [:p [:<> \"What is the value of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" given the \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" coin tosses that we have seen?\"]]] [:p [:<> \"In a Bayesian setting, we typically try to quantify our uncertainty over our\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"guesses, so rather than asking for a specific value of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" we can ask\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"for a distribution over values of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [:blockquote [:p [:<> \"What is the distribution over \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" given the \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" coin tosses that we have seen?\"]]] [:p [:<> \"To understand this better, consider the following question.\"]] [:blockquote [:p [:<> \"If the distribution over \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" was represented as a beta distribution\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"like those below, what would it look like if \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"29/100\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" of the outcomes were\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"heads? What if \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"79/100\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" of the outcomes were heads?\"]]] [:p] [:p [:<> \"These last two questions are standard examples of the problem of \"] [:em [:<> \"posterior\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"inference\"]] [:<> \" in probabilistic modeling. The term \"] [:em [:<> \"posterior\"]] [:<> \" refers to the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"distribution of a latent RV \"] [:strong [:<> \"after\"]] [:<> \" observing some data points. We would\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"like to compute the \"] [:em [:<> \"posterior distribution\"]] [:<> \" over latent random variables\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"given the observed random variables.\"]] [:p [:<> \"There is a second kind of inference problem which is commonly considered in Bayesian statistics.\"]] [:blockquote [:p [:<> \"What is the distribution over the next coin flip, given the preceding coin flips.\"]]] [:p [:<> \"This is the statement of another a type of inference problem often called\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:em [:<> \"posterior predictive inference\"]] [:<> \". The \"] [:em [:<> \"posterior predictive distribution\"]] [:<> \" is\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the distribution over next observations given the preceding observations,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"averaging over posterior values of the latent random variables. In order to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"model the posterior predictive distribution, we will have to introduce a new\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"latent random variable \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{N+1}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", as a placeholder for the next coin flip\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"after observing the previous coin flips.\"]] [\"h1\" {:id \"inference-via-conditioning\"} [:<> \"Inference via Conditioning\"]] [:p [:<> \"We have seen an inference problem stated as finding the distribution of some\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"unknown random variables given some known random variables. But what \"] [:strong [:<> \"is\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the distribution over these unknown random variables? In each case, we are\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"looking for a \"] [:em [:<> \"conditional distribution\"]] [:<> \" over the unknown variables given the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"values of the known variables.\"]] [:p [:<> \"In the simulation unit, we talked about the interpretation of conditional\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"probabilities.\"]] [:blockquote [:p [:<> \"For a conditional distribution, we are \"] [:strong [:<> \"required\"]] [:<> \" to use the value of\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the random variable specified in the condition; we absolutely \"] [:strong [:<> \"must\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"have\"]] [:<> \" this information to draw our sample.\"]]] [:p [:<> \"In Bayesian statistics, we represent posterior and posterior inference\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"problems using conditional distributions. For instance, when the distribution\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" given some observed coin tosses is represented by\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta \\\\mid \\\\{X_{i}\\\\}_{i=1}^N, \\\\alpha, \\\\beta ).\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Clearly if we are reasoning about plausible values of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" given our\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"data, then the \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\{X_{i}\\\\}_{i=1}^N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is required.\"]] [:p [:<> \"However, we now have a problem. The model definition which was given by the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"following joint expression\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta, \\\\{X^{(i)}\\\\}_{i=1}^N \\\\mid \\\\alpha, \\\\beta) = \\\\Pr(\\\\theta \\\\mid \\\\alpha, \\\\beta) \\\\prod_{i=1}^N \\\\Pr(X^{(i)}\\\\mid \\\\theta).\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"All the conditional distributions here, \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{i}\\\\mid \\\\theta)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" are simply\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"part of the definition of the model.\"]] [:p [:<> \"However, the conditional distribution above is not part of the model\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"definition, For unknown conditional distributions such as this, we must\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"compute their values using the laws of probability theory. In the next\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"sections we will see how to do this.\"]] [\"h1\" {:id \"operations-of-probability-theory\"} [:<> \"Operations of Probability Theory\"]] [:p [:<> \"We have set ourselves the goal of computing posterior distributions such as\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta \\\\mid \\\\{X_{i}\\\\}_{i=1}^N, \\\\alpha, \\\\beta )\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Given a particular generative model, we always start with a joint\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"distribution over random variables such as\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta \\\\mid \\\\alpha, \\\\beta) \\\\prod_{i=1}^N \\\\Pr(X_{i}\\\\mid \\\\theta)\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"How do we compute the first distribution starting from the second\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"distribution as input. Probability theory makes use of two operations which\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"we can use to do this: \"] [:em [:<> \"marginalization\"]] [:<> \" and \"] [:em [:<> \"conditioning\"]] [:<> \". Since\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"conditioning is defined in terms of marginalization, we will start with the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"former.\"]] [\"h1\" {:id \"marginalization\"} [:<> \"Marginalization\"]] [:p [:<> \"For a given joint distribution, say \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(A,B)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", a \"] [:em [:<> \"marginal distribution\"]] [:<> \" is\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"some distribution that only contains a subset of the random variables in the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"joint, such as \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(A)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(B)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [:p [:<> \"More generally, for some set of random variables $\\\\mathbf{X}={X_{1}, \\\\dots,\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"X_{K}}$ there are \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"|\\\\mathcal{P}(\\\\mathbf{X})|-1 = 2 ^{K}-1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" possible marginal\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"distributions.\"]] [:p [:<> \"How are marginal distributions related to joint distributions?\"]] [:p [:<> \"The definition of marginalization is given by\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(A=a) = \\\\sum_{b\\\\in B} \\\\Pr(A=a, B=b)\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"if \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"B\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is a discrete random variable or if \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"B\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is a continuous random\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"variable\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(A) = \\\\int \\\\Pr(A, B=b) db\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"More generally\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{1}, \\\\dots, X_{M})= \\\\sum_{X_{M+1}} \\\\dots \\\\sum_{X_{K}} \\\\Pr(X_{1}, \\\\dots, X_{M}, X_{M+1}, \\\\dots, X_{K})\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"where the sums are replaced by integrals where appropriate. Often the following notation is used.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{1}, \\\\dots, X_{M})= \\\\sum_{X_{M+1},\\\\dots,X_{K}} \\\\Pr(X_{1}, \\\\dots, X_{M}, X_{M+1}, \\\\dots, X_{K})\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"In other words, marginalization refers to the process of summing over all of\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the values of some of the random variables in a joint distribution.\"]] [:p [:<> \"Marginal distributions are called as such because if we think about the tabular view of joint distributions, they can be written in the \\\"margins\\\" of the table. Returning to our \"] [:code [:<> \"flip_two\"]] [:<> \" example from the last unit.\"]] [:table [:thead [:tr [:th {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{1}\\\\backslash X_{2}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:th {:style nil} [:code [:<> \"true\"]]] [:th {:style nil} [:code [:<> \"false\"]]] [:th {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{1})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]]] [:tbody [:tr [:td {:style nil} [:code [:<> \"true\"]]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{true},\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{true}, \\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X^{(1)}}(\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [:code [:<> \"false\"]]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{false}, \\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{false},\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X^{(1)}}(\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{2})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{2}}(\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{2}}(\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil}]]]] [:p [:<> \"We say that we marginalize \"] [:em [:<> \"over\"]] [:<> \" a variable like \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{1}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" or we \"] [:em [:<> \"marginalize\"]] [:<> \" \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{1}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" \"] [:em [:<> \"away\"]] [:<> \".\"]] [:p [:<> \"Intuitively, \"] [:strong [:<> \"marginalization is a way of getting rid of random variables in a joint distribution\"]] [:<> \".\"]] [\"h1\" {:id \"samplers,-scorers,-and-marginalization\"} [:<> \"Samplers, Scorers, and Marginalization\"]] [:p [:<> \"In the last unit, we introduced the idea that there were two different kinds representations for probability distributions: \"] [:em [:<> \"scorers\"]] [:<> \" which were functions that returned the density of points in the sample space of the distribution and \"] [:em [:<> \"samplers\"]] [:<> \" which are function which return elements from the sample space of the distribution at a rate proportional to their densities.\"]] [:p [:<> \"In the definitions of marginalization above, we implicitly took the scoring view: we defined a procedure for taking a scorer for a joint distribution and returning a scorer for the target marginal. Thus, we can think of marginalization as a higher order operation that takes a scorer representation of a joint distribution, as well as a specification of which variables to preserve and returns a scorer representation of the desired marginal:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\texttt{scorer} \\\\times\\\\ \\\\{X_{1},\\\\dots,X_{M}\\\\} \\\\rightarrow \\\\texttt{scorer}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Scorer marginalization can be a very expensive operation as it requires us to do a sum over every value of every random variable that we wish to marginalize away. If these random variables have large supports and there are many of them, then we will be marginalizing over a cartesian product which can be extraordinarily large.\"]] [:p [:<> \"Viewing marginalization as a higher order function from scorers to scorers raises an interesting quesiton:\"]] [:blockquote [:p [:<> \"What is marginalization viewed as a higher order function from samplers to samplers?\"]]] [:p [:<> \"It turns out that marginalization for samplers is much easier than in the case of scorers.\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"If we have a generative function that samples from some joint distribution marginalization corresponds to simply forgetting, ignoring, or not returning the values of the  random variables that have been marginalized away.\"]] [:p [:<> \"In other words, we can simply draw a sample from our joint and only return the desired target variables in \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\{X_{1},\\\\dots,X_{M}\\\\}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\texttt{sampler} \\\\times\\\\ \\\\{X_{1},\\\\dots,X_{M}\\\\} \\\\rightarrow \\\\texttt{sampler}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"One important question we need to ask is if this gives a \"] [:em [:<> \"correct sampler\"]] [:<> \". A sampler is correct if it returns values at rates proportional to their densities.\"]] [:blockquote [:p [:<> \"Does forgetting give us a correct sampler for  marginal distributions?\"]]] [:p [:<> \"We see here our first suggestion of why the sampling perspective may be  computationally adventageous in some cases. While scoring a marginal probability over a set of random variables can be exponentially costly, sampling from the same marginal is typically quite cheap.\"]] [\"h1\" {:id \"conditioning\"} [:<> \"Conditioning\"]] [:p [:<> \"We have discussed how joint distributions such as \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(A,B)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" are related to marginal\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"distributions such as \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(A)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(B)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", and the operation\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"that relates them: marginalization. We are now in a position to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"introduce another\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"fundamental operation from probability theory: \"] [:em [:<> \"conditionalization\"]] [:<> \" or \"] [:em [:<> \"conditioning\"]] [:<> \".  Conditioning as an operation can be thought of as a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"form of hypothetical reasoning where we ask about the probability\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"distribution over some (set of) random variables, assuming some other\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"random variables take on some particular values. For instance, we\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"might ask what the probability distribution is over \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{2}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" given\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"that \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{1}=\\\\texttt{true}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". We write the conditional probability as $\\\\Pr(X_{2}=x_{2}\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"\\\\mid X_{1}=\\\\texttt{true})$. The expression to the right of the conditioning bar is\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"called the \"] [:em [:<> \"conditioner\"]] [:<> \" and can be any predicate that we require to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"be true.\"]] [:p [:<> \"For discrete random variables, conditioning is defined as follows:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X=x | Y=y) = \\\\frac{\\\\Pr(X=x,Y=y)}{\\\\Pr(Y=y)} = \\\\frac{\\\\Pr(X=x,Y=y)}{\\\\sum_{x^{\\\\prime} \\\\in X} \\\\Pr(X=x^{\\\\prime},Y=y)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"or more generally\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{1}, \\\\dots, X_{M} \\\\mid X_{M+1}=x_{M+1}, \\\\dots, X_{K}=x_{K})= \\\\frac{Pr(X_{1}, \\\\dots, X_{M}, X_{M+1}, \\\\dots, X_{K})}{\\\\sum_{X_{1}} \\\\dots \\\\sum_{X_{M}} \\\\Pr(X_{1}, \\\\dots, X_{M}, X_{M+1}, \\\\dots, X_{K})}=\\\\frac{Pr(X_{1}, \\\\dots, X_{M}, X_{M+1}, \\\\dots, X_{K})}{\\\\Pr(X_{M+1}, \\\\dots, X_{K})}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"We can think of conditioning as a two step process. First, we get the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"subset of joint states where the conditioner is true, that is, removing all of the states where the conditioner is\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"false. We then renormalize the joint probabilities of these states so\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"that they are a probability distribution again by dividing through by\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the marginal probability of the conditioner.\"]] [:p [:<> \"One can think of\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"conditioning as \\\"zooming in\\\" on the part of the joint space we are\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"interested in (the part where the conditioner is true) and then making\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the result a probability distribution by renormalizing in order to make things add\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"to \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [:p [:<> \"Let's consider the following joint distribution again.\"]] [:table [:thead [:tr [:th {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{1}\\\\backslash X_{2}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:th {:style nil} [:code [:<> \"true\"]]] [:th {:style nil} [:code [:<> \"false\"]]] [:th {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{1})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]]] [:tbody [:tr [:td {:style nil} [:code [:<> \"true\"]]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{true},\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{true}, \\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{1}}(\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [:code [:<> \"false\"]]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{true}, \\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{false},\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{1}}(\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{2})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{2}}(\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{2}}(\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil}]]]] [:p [:<> \"Suppose that we want to ask about the conditional distribution \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{1} \\\\mid X_{2}=\\\\mathtt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". In this case, we only care about the final column of the joint distribution.\"]] [:table [:thead [:tr [:th {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X_{1}\\\\backslash X_{2}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:th {:style nil} [:code [:<> \"true\"]]] [:th {:style nil} [:code [:<> \"false\"]]]]] [:tbody [:tr [:td {:style nil} [:code [:<> \"true\"]]] [:td {:style nil} [:<> \"-\"]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{true}, \\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [:code [:<> \"false\"]]] [:td {:style nil} [:<> \"-\"]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(\\\\texttt{false},\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X_{2})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:td {:style nil} [:<> \"-\"]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p_{X_{2}}(\\\\texttt{false})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]]]] [:p [:<> \"To make this into a conditional distribution we renormalize.\"]] [:table [:thead [:tr [:th {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X^{(1)}\\\\backslash X^{(2)}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]] [:th {:style nil} [:code [:<> \"true\"]]] [:th {:style nil} [:code [:<> \"false\"]]]]] [:tbody [:tr [:td {:style nil} [:code [:<> \"true\"]]] [:td {:style nil} [:<> \"-\"]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{p(\\\\texttt{true}, \\\\texttt{false})}{p_{X_{2}}(\\\\texttt{false})}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]] [:tr [:td {:style nil} [:code [:<> \"false\"]]] [:td {:style nil} [:<> \"-\"]] [:td {:style nil} [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{p(\\\\texttt{false},\\\\texttt{false})}{p_{X_{2}}(\\\\texttt{false})}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}]]]]] [:p [:<> \"Notice what this means: The conditional probability of an outcome is related to the joint probability of the same outcome by a normalizing constant—since the probability of the conditioner is the same for all values of the conditioned variables. That is, whatever states remain in the distribution after condititioning have the same probabilities proportional to one another, even though their absolute probabilities may change. Conditioning is—in a sense that can be made precise—the maximally \"] [:em [:<> \"conservative\"]] [:<> \" operation one can perform to implement hypothetical reasoning and still obey the laws of probability theory. Nevertheless, despite its simplicity, conditioning can have surprisingly rich consquences.\"]] [:p [:<> \"The fact that the joint and conditional are related by a normalizing constant will prove to be useful in defining a number of algorithms we will explore in this course.\"]] [\"h1\" {:id \"samplers,-scorers,-and-conditioning\"} [:<> \"Samplers, Scorers, and Conditioning\"]] [:p [:<> \"Above, we defined conditioning once again in terms of scoring. It can be thought of as a higher order function which takes a scorer representation of a distribution as well as the random variables and values to condition on\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\texttt{scorer} \\\\times\\\\ \\\\{X_{M+1}=x_{M+1}, \\\\dots, X_{K}=x_{K} \\\\} \\\\rightarrow \\\\texttt{scorer}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:blockquote [:p [:<> \"What is the sampling equivalent to conditioning?\"]]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\texttt{sampler} \\\\times\\\\ \\\\{X_{M+1}=x_{M+1}, \\\\dots, X_{K}=x_{K} \\\\} \\\\rightarrow \\\\texttt{sampler}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"As we will see below, this does not have nearly as simple an answer as the same question about marginalization.\"]] [\"h2\" {:id \"bayes'-rule\"} [:<> \"Bayes' Rule\"]] [:p [:<> \"Combining the definition of conditional probability with the chain\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"rule, we end up with an important special-case law of probability\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"known as \"] [:em [:<> \"Bayes' Rule\"]] [:<> \":\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(H=h \\\\mid D=d)=\\\\frac{\\\\Pr(D=d,  H=h)}{\\\\sum_{h'\\\\in H} \\\\Pr(D=d \\\\mid H=h')\\\\Pr(H=h')}=\\\\frac{\\\\Pr(D=d \\\\mid H=h)\\\\Pr(H=h)}{\\\\sum_{h'\\\\in H} \\\\Pr(D=d \\\\mid H=h')\\\\Pr(H=h')}=\\\\frac{\\\\Pr(D=d \\\\mid H=h)\\\\Pr(H=h)}{\\\\Pr(D=d)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Note that this is just the definition of conditional probability with\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(D=d \\\\mid H=h)P(H=h)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" substituted for \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(D=d, H=h)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" via the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"chain rule.  Bayes' rule is often written in this form with \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"H\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"standing for a random variable representing some hypothesis, that is the latent variables in our model. \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"D\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" stands for  \"] [:em [:<> \"data\"]] [:<> \" and represents the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"observed variables in our model.\"]] [:p [:<> \"The term \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(H=h \\\\mid D=d)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is known as the \"] [:em [:<> \"posterior probability\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"of the hypothesis given the data. The term \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(H=h)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is known as\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the \"] [:em [:<> \"prior probability\"]] [:<> \" of the hypothesis.  The term $\\\\Pr(D=d \\\\mid\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"H=h)$ is known as the \"] [:em [:<> \"likelihood of the hypothesis\"]] [:<> \" (or less\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"correctly, but still often, likelihood of the data), and the term\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\sum_{h'\\\\in H} \\\\Pr(D=d \\\\mid H=h')\\\\Pr(H=h')\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is known as the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:em [:<> \"evidence\"]] [:<> \" or, more often, \"] [:em [:<> \"marginal likelihood\"]] [:<> \" of the data. Note that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\sum_{h'\\\\in H} \\\\Pr(D=d \\\\mid H=h')\\\\Pr(H=h')=\\\\Pr(D)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", so this\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"denominator is just the marginal probability of the data\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"(marginalizing over all hypotheses).\"]] [:p [:<> \"In the context of one of our joint models, we typically think\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"of the variable \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"H\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" as containing all of the latent random variables\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"in our model, while the variable \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"D\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" contains all of the observed\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"random variables. For instance, \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"H =\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"D = X^{(1)}, \\\\dots, X^{(N)}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" in our biased coin model.\"]] [:p [:<> \"There is nothing particularly special about Bayes'rule. It is just a straightforward application of some basic laws of probability theory. As we have discussed, which random variables in a model are seen as latent and which are seen as observed just depends on the application of our model. However, Bayes' rule does provide a convenient way of talking about different parts of our model: the prior over latent variables; the posterior over those same variables; the likelihood of the latent variables   given the observed; and the marginal likelihood of those variables, marginalizing away the latent variables. We will often use this terminology going forward.\"]] [:p [:<> \"There is an important ways of thinking about how to use Bayes' rule. It gives a law relating our prior beliefs about our latents to our beliefs about the latents after observing some variables. We can apply this any number of times to sequentially update our beliefs. Examining the rule again, we see that\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(H=h \\\\mid D=d)\\\\propto \\\\Pr(D=d \\\\mid H=h)P(H=h)\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"In other words, our posterior beliefs in our latents are proportional to our prior beliefs, reweighted by a term that corresponds to the probability that the latent generated the observed values. One again, we see how probability theory is  conservative in terms of belief updating.\"]] [\"h2\" {:id \"the-posterior-predictive-distribution\"} [:<> \"The Posterior Predictive Distribution\"]] [:p [:<> \"Let \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"D^\\\\prime\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" be a random variable representing the unobserved \"] [:em [:<> \"next\"]] [:<> \" datapoint we might sample from our model. The posterior predictive distribution is defined by:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(D^\\\\prime=d^\\\\prime \\\\mid D=d) = \\\\sum_H \\\\Pr(D^\\\\prime=d^\\\\prime \\\\mid H=h) \\\\Pr(H=h \\\\mid D=d),\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"or expanding terms:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(D^\\\\prime=d^\\\\prime \\\\mid D=d) = \\\\sum_H \\\\Pr(D^\\\\prime=d^\\\\prime \\\\mid H=h) \\\\frac{\\\\Pr(D=d \\\\mid H=h)P(H=h)}{\\\\sum_{h'\\\\in H} \\\\Pr(D=d \\\\mid H=h')\\\\Pr(H=h')}.\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"In other words, it is defined by computing the distribution of the next observing averaging over all values of the latent random variables, weighting each by their posterior probability.\"]] [\"h1\" {:id \"posterior-for-the-biased-coin-model\"} [:<> \"Posterior for the Biased Coin Model\"]] [:p [:<> \"Let's write down the posterior and posterior predictive for our biased coin model. Because of the simplicity of this model, there is an exact form for these distributions which we can derive with a little calculus.\"]] [:p [:<> \"The joint probability of the observed and latent random variables for the model is:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\{x_i\\\\}_{i=1}^N, \\\\theta) = \\\\Pr(\\\\theta)\\\\prod_i^N \\\\Pr(x_i|\\\\theta)\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [\"h2\" {:id \"posterior\"} [:<> \"Posterior\"]] [:p [:<> \"We first write down the posterior using the definition of conditional probability.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta|\\\\{x_i\\\\}_i^N) = \\\\frac{\\\\left[\\\\prod_i^N \\\\Pr(x_i|\\\\theta)\\\\right]\\\\Pr(\\\\theta)}{\\\\Pr(\\\\{x_i\\\\}_{i=1}^N)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"We then substitute the marginal in the denominator with its definition as an integral.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta|\\\\{x_i\\\\}_i^N) = \\\\frac{\\\\left[\\\\prod_i^N \\\\Pr(x_i|\\\\theta)\\\\right]\\\\Pr(\\\\theta)}{\\\\int_\\\\theta\\\\left[\\\\prod_i^N\\\\Pr(x_i|\\\\theta)\\\\right]\\\\Pr(\\\\theta)d\\\\theta}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"We now plug in the type of each of the probabilities above.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\left[\\\\prod_i^N \\\\mathrm{Bernoulli}(x_i;\\\\theta)\\\\right]\\\\mathrm{Beta}(\\\\theta;\\\\alpha,\\\\beta)}{\\\\int_\\\\theta \\\\left[\\\\prod_i^N\\\\mathrm{Bernoulli}(x_i;\\\\theta)\\\\right] \\\\mathrm{Beta}(\\\\theta;\\\\alpha,\\\\beta)d\\\\theta}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Replacing those types with densities, we get:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\frac{\\\\Gamma(\\\\alpha)\\\\Gamma(\\\\beta)}{\\\\Gamma(\\\\alpha + \\\\beta)} \\\\theta^{\\\\alpha + N_h - 1}(1-\\\\theta)^{\\\\beta + N_t - 1}}{\\\\frac{\\\\Gamma(\\\\alpha)\\\\Gamma(\\\\beta)}{\\\\Gamma(\\\\alpha + \\\\beta)}\\\\int \\\\theta^{\\\\alpha + N_h - 1}(1-\\\\theta)^{\\\\beta + N_t - 1}d\\\\theta}.\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"The constant term at the beginning which is a ratio of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Gamma(\\\\cdot)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" functions cancels.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{ \\\\theta^{\\\\alpha + N_h - 1}(1-\\\\theta)^{\\\\beta + N_t - 1}}{\\\\int \\\\theta^{\\\\alpha + N_h - 1}(1-\\\\theta)^{\\\\beta + N_t - 1}d\\\\theta}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Taking the integral on the bottom gives us:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\Gamma(N + \\\\alpha + \\\\beta)}{\\\\Gamma(\\\\alpha + N_h)\\\\Gamma(\\\\beta + N_t)} \\\\cdot \\\\theta^{\\\\alpha + N_h - 1}(1-\\\\theta)^{\\\\beta + N_t - 1}.\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Here we used the fact that\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\Gamma(x)\\\\Gamma(y )}{\\\\Gamma(x+y)} = \\\\int_{\\\\Theta} \\\\theta^{x- 1}(1-\\\\theta)^{y - 1} d\\\\theta.\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"This last expression is just the definition of a Beta distribution with new parameters!\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\mathrm{Beta}(\\\\theta; \\\\alpha + N_h, \\\\beta + N_t)\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Interestingly, we see that the posterior for our model, that is the distribution that quantifies our uncertainty over the parameter \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" after observing data, is another beta distribution, with adjusted parameters.\"]] [:blockquote [:p [:<> \"What is the interpretation of the new beta parameters.\"]]] [\"h2\" {:id \"posterior-predictive\"} [:<> \"Posterior predictive\"]] [:p [:<> \"The posterior predictive distribution asks what is the distribution over next possible sampled observed values, given the preceding observed values. We compute it by averaging over the posterior.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(x^{(N+1)}=h|\\\\{x\\\\}_i^N) = \\\\int \\\\Pr(x_{N+1}=h|\\\\theta)\\\\Pr(\\\\theta|\\\\{x\\\\}_i^N)d\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"We substitute in the defintion of each of the pieces above.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\int \\\\theta \\\\cdot \\\\theta^{\\\\alpha + N_h-1}(1-\\\\theta)^{\\\\beta+N_t-1} \\\\frac{\\\\Gamma(N + \\\\alpha + \\\\beta)}{\\\\Gamma(\\\\alpha + N_h)\\\\Gamma(\\\\beta + N_t)} d\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Next we move the constant term outside of the integral.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\Gamma(N + \\\\alpha + \\\\beta)}{\\\\Gamma(\\\\alpha + N_h)\\\\Gamma(\\\\beta + N_t)} \\\\int \\\\theta^{\\\\alpha + N_h}(1-\\\\theta)^{\\\\beta+N_t-1}d\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"We now take the integral and get a product of two ratios involving the gamma function.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\Gamma(\\\\alpha+\\\\beta+N)}{\\\\Gamma(\\\\alpha+N_h)\\\\Gamma(\\\\beta+N_t)} \\\\cdot \\\\frac{\\\\Gamma(\\\\alpha+N_h+1)\\\\Gamma(\\\\beta+N_t)}{\\\\Gamma(\\\\alpha+\\\\beta+N+1)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Simplifying a bit\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\Gamma(\\\\alpha+\\\\beta+N)}{\\\\Gamma(\\\\alpha+\\\\beta+N+1)} \\\\cdot \\\\frac{\\\\Gamma(\\\\alpha+N_h+1)}{\\\\Gamma(\\\\alpha+N_h)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Using some properties of the Gamma function (namely that it is like the factorial) we can simplify the above to\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \" = \\\\frac{\\\\alpha+N_h}{\\\\alpha+\\\\beta + N}.\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:blockquote [:p [:<> \"What is our predicted probability of heads? How does it take into account the data we have observed?\"]]] [\"h1\" {:id \"rejection-sampling\"} [:<> \"Rejection Sampling\"]] [:p [:<> \"Above, we asked what the sampling equivalent to conditioning was. There are many possible anwers to this question, many of which we will explore in this course. However, probably the simplest and easiest to understand is \"] [:em [:<> \"rejection sampling\"]] [:<> \".\"]] [:p [:<> \"Rejection sampling is a form of \\\"guess and check\\\"—we simply sample from the prior and then check to see if our conditioner is met. If it is, we return our sample, otherwise, we try again until we get a sample that matches the conditioner.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.code-viewer.code-listing [#viewer-eval nextjournal.clerk.render/inspect-presented {:path [0], :nextjournal/value \"\\n# This function iterates over a ChoiceMap\\nfunction iter_deep(c::Gen.ChoiceMap)\\n  Iterators.flatten([\\n      Gen.get_values_shallow(c),\\n      (Dict(Pair{Any, Any}(k => kk, vv) for (kk, vv) in iter_deep(v))\\n       for (k, v) in Gen.get_submaps_shallow(c))...,\\n  ])\\nend\\n\\n# Check if the conditions hold\\nfunction check_conditions(trace, constraints)\\n    for (name, value) in iter_deep(constraints)\\n        if trace[name] != value return false end\\n    end\\n    return true\\nend\\n\\nfunction rejection(generative_model, arguments, constraints)\\n    t=Gen.simulate(generative_model,arguments)\\n    if check_conditions(t,constraints)\\n        t\\n    else\\n        rejection(generative_model, arguments, constraints)\\n    end\\nend\\n\\nobservations = Gen.choicemap()\\nobservations[:x => 1] = true\\nobservations[:x => 2] = true\\n\\nvalid_trace=rejection(flip_biased_coin, (3,), observations)\\nGen.get_choices(valid_trace)\\n\\n```julia\\nnum_flips=3\\nobservations = Gen.choicemap()\\n\\nhistogram([rejection(flip_biased_coin, (num_flips,),\\n            observations)[:θ] for _ in 1:100000])\\n\\n```julia\\nnum_flips=3\\nobservations = Gen.choicemap()\\n\\nfor i in 1:(num_flips-1)\\n    observations[:x => i] = true\\nend\\n\\nhistogram([rejection(flip_biased_coin, (num_flips,),\\n            observations)[:θ] for _ in 1:100000])\", :nextjournal/render-opts {:language \"julia\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.code-viewer.code-listing [#viewer-eval nextjournal.clerk.render/inspect-presented {:path [0], :nextjournal/value \"num_flips=5\\nobservations = Gen.choicemap()\\n\\nfor i in 1:(num_flips-1)\\n    observations[:x => i] = true\\nend\\n\\nhistogram([rejection(flip_biased_coin, (num_flips,),\\n            observations)[:θ] for _ in 1:100000])\\n\\n```julia\\nnum_flips=30\\nobservations = Gen.choicemap()\\n\\nfor i in 1:(num_flips-1)\\n    observations[:x => i] = true\\nend\\n\\nhistogram([rejection(flip_biased_coin, (num_flips,),\\n            observations)[:θ] for _ in 1:100000])\", :nextjournal/render-opts {:language \"julia\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:p [:<> \"Recall that a correct sampler must return values at a rate which is proportional to their true density. Thus, for rejection sampling to be a correct posterior inference algorithm, it must return latent variable values proportional to their posterior probability. Here is an informal argument that rejection sampling is correct.\"]] [:p [:<> \"Suppose that we are trying to represent a conditional distribution \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta | X=\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". In rejection sampling we sample from the joint distribution \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta, X)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and only keep samples that satisfy the condition, that is, \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(\\\\theta, X=\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [:p [:<> \"If we ignore the value of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and only insist that \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X=\\\\texttt{true}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" the proportion of samples we keep will converge to \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X=\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". In other words, if\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is the number of samples, and \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N_{X=\\\\texttt{true}}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" was the number of samples where \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\texttt{true}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" then \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{N_{X=\\\\texttt{true}}}{N}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" will tend to \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X=\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" as \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" gets large.\"]] [:p [:<> \"However, instead of ignoring our sampled values of \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", we return it. Consider a particular value \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\breve{\\\\theta}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", where the breve indicates some particular value of the the variable. Let's let the number of samples where \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is equal to this value and the condition is met be  \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N_{\\\\breve{\\\\theta},X=\\\\texttt{true}}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". Out of our overall samples returned the (sub)proportion where \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta=\\\\breve{\\\\theta}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is given by.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{N_{\\\\breve{\\\\theta},X=\\\\texttt{true}}}{N_{X=\\\\texttt{true}}}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Note that this is equal to\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{\\\\frac{N_{\\\\breve{\\\\theta},X=\\\\texttt{true}}}{N}}{\\\\frac{N_{X=\\\\texttt{true}}}{N}}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"which will tend towards\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{\\\\Pr(\\\\breve{\\\\theta},X=\\\\texttt{true})}{\\\\Pr(X=\\\\texttt{true})} = \\\\Pr(\\\\breve{\\\\theta} \\\\mid X=\\\\texttt{true})\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"as \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"N \\\\rightarrow \\\\infty\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". And, of course, this is just our definition of conditional probability (in the discrete case).\"]] [:p [:<> \"In cases where our condition has probability greater than \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"0\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and our generative model halts with probability \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", rejection sampling is guaranteed to be a correct sampling algorithm.\"]] [:blockquote [:p [:<> \"What problems do you see with the rejection sampling approach to inference?\"]]] [\"h1\" {:id \"the-cost--of-rejection-sampling\"} [:<> \"The Cost  of Rejection Sampling\"]] [:p [:<> \"Just how long will it take our rejection sampling algorithm to \\\"hit\\\" the observed dataset? To give an answer to this question, it is useful to first introduce the concept of the \"] [:em [:<> \"geometric distribution\"]] [:<> \".\"]] [\"h2\" {:id \"geometric-distributions\"} [:<> \"Geometric Distributions\"]] [:p [:<> \"The \"] [:em [:<> \"geometric distribution\"]] [:<> \" with parameter \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is the distribution over numbers of  flips of a coin with bias \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" until the first flip comes up heads.  It can be expressed with the following generative process.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.code-viewer.code-listing [#viewer-eval nextjournal.clerk.render/inspect-presented {:path [0], :nextjournal/value \"@gen function geometric(θ)\\n   if bernoulli(θ)\\n        return(1)\\n    else\\n        1+geometric(θ)\\n    end\\nend;\\n\\nhistogram([geometric(0.5) for _ in 1:1000], label=false)\", :nextjournal/render-opts {:language \"julia\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:p [:<> \"Let's take a moment to consider this generative process. The generative process can be thought of as walking along the natural numbers\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"flipping a coin, with probability \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" at each natural number. If\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"the coin comes up \"] [:code [:<> \"true\"]] [:<> \" at natural number \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"k\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" then we stop\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"and return  \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"k\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". Otherwise, we continue and repeat the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"process at \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"k+1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". Thus, the probability distribution over integers\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"defined by this process is given by the following expression\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"(recalling that \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1-\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is the probability of \"] [:strong [:<> \"not\"]] [:<> \" stopping at a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"particular \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"k\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \").\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"p(k;\\\\theta) = \\\\theta (1-\\\\theta)^{(k-1)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"The\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"geometric distribution is a distribution on the natural numbers\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\mathbb{N}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" which is parameterized by a fixed \"] [:em [:<> \"success probability\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [:p [:<> \"At this point, something may concern you. The set of probabilities characterizing a distribution\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"must sum to \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". But now we have defined the geometric distribution\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"over the countably infinite set \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\mathbb{N}\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". Does it sum to \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \"?\"]] [:p [:<> \"Recall that a series of the form\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"a + ar + ar^2 + ar^3 + ...\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"is called a \"] [:em [:<> \"geometric series\"]] [:<> \". When \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"|r|<1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", the sum of a such a geometric series is given by the following expression:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"a + ar + ar^2 + ar^3 + ...  = \\\\sum_{k=1}^\\\\infty ar^{(k-1)} = \\\\frac{a}{1-r}, \\\\\\n \\\\text{for} |r|<1.\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"For the geometric distribution, we set \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"a=\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"r=(1-\\\\theta)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"terms of this sum represent the probabilities of the outcomes at each\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"natural number \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"k\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\sum_{k=1}^\\\\infty \\\\theta (1-\\\\theta)^{(k-1)}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"in other words\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta + \\\\theta(1-\\\\theta) + \\\\theta(1-\\\\theta)^2 + \\\\theta(1-\\\\theta)^3 + ...\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"The sum of this series is\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\frac{\\\\theta}{1-(1-\\\\theta)} = \\\\frac{\\\\theta}{\\\\theta} = 1\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Thus, this sequence sums to \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", and thus we have defined a\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}] [:<> \"well-formed probability distribution over the natural numbers.\"]] [\"h2\" {:id \"expectation-of-a-geometric-distribution\"} [:<> \"Expectation of a Geometric Distribution\"]] [:p [:<> \"Let's use our definitions above to compute the expectation of a geometric distribution, that is, the expected number of coing flips until we halt.\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"K \\\\sim \\\\mathrm{geometric}(\\\\theta)\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"Using the definition of expectations and our expression for the sum of a geometric series (several times) we have:\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\begin{align}\\\\mathbb{E}[K] &= \\\\sum_{k=1}^\\\\infty k (1-\\\\theta)^{k-1}\\\\theta  \\\\\\\\\\n \\\\mathbb{E}[K] &= \\\\theta \\\\left[ \\\\sum_{k=1}^\\\\infty  (1-\\\\theta)^{k-1} + \\\\sum_{k=2}^\\\\infty  (1-\\\\theta)^{k-1} + \\\\sum_{k=3}^\\\\infty  (1-\\\\theta)^{k-1} +\\\\dots \\\\right] \\\\\\\\\\n \\\\mathbb{E}[K] &= \\\\theta \\\\left[ \\\\sum_{k=1}^\\\\infty  (1-\\\\theta)^{k-1} + (1-\\\\theta) \\\\sum_{k=1}^\\\\infty  (1-\\\\theta)^{k-1} + (1-\\\\theta)^2 \\\\sum_{k=1}^\\\\infty  (1-\\\\theta)^{k-1} +\\\\dots \\\\right] \\\\\\\\\\n \\\\mathbb{E}[K] &= \\\\theta \\\\left[ 1/\\\\theta + (1-\\\\theta)/\\\\theta + (1-\\\\theta)^2/\\\\theta + \\\\dots \\\\right] \\\\\\\\\\n \\\\mathbb{E}[K] &= 1 + (1-\\\\theta) + (1-\\\\theta)^2 + \\\\dots \\\\\\\\\\n \\\\mathbb{E}[K] &= 1/\\\\theta \\\\\\\\\\n \\\\end{align}\", :nextjournal/viewer {:name :nextjournal.markdown/block-formula, :render-fn #viewer-fn nextjournal.clerk.render/render-katex, :hash \"5dtLYB93Mi3NowoYurf1Ue76yrXtDC\"}}] [:p [:<> \"In other words, the expected number of coin tosses of a biased coin with weight \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" before you see the first \"] [:code [:<> \"true\"]] [:<> \" value is \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1/\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". To put that in perspective, if the probabilty \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\theta\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" is rational, it can be written as \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1/n\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" for some positive integer \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"n\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" and this the expected number of coin tosses is \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"n\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \".\"]] [\"h1\" {:id \"rejection-sampler-as-a-geometric-distribution\"} [:<> \"Rejection Sampler as a Geometric Distribution\"]] [:p [:<> \"If our conditioner is \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"X=x\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \", then the marginal probability of the condition \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"\\\\Pr(X=x)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \" represents the percentage of the time we should expect a  random sample from the joint distribution to be consistent with the condition. Our arguments above showed then that the expected number of samples we should expect to take, on average, before we see one which satisfies the conditioner is \"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value \"1/\\\\Pr(X=x)\", :nextjournal/viewer {:name :nextjournal.markdown/formula, :render-fn #viewer-fn (fn [tex] (nextjournal.clerk.render/render-katex tex {:inline? true})), :hash \"5dt6DiPBjaZbeXfXmhPfzC4UAAhKDu\"}}] [:<> \". How does this play out in practice?\"]] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:div.code-viewer.code-listing [#viewer-eval nextjournal.clerk.render/inspect-presented {:path [0], :nextjournal/value \"observations = Gen.choicemap()\\n\\nfor i in 1:10000\\n    observations[:x => i] = true\\nend\\n\\nvalid_trace=rejection(flip_biased_coin, (20000,), observations)\\nGen.get_choices(valid_trace)\", :nextjournal/render-opts {:language \"julia\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code, :hash \"5dsJQw12yyyd7TcZEf52VSHxnqnJUC\"}}]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5drpr3yzJ1CcHNbRHnK2sVyn7YUmXB\"}}]], :nextjournal/render-opts {:id \"user/markdown-5du1pzfHiHgmykaf44fkzv7SJitixh\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsg4Bx9A9L7WvvCgamUoRtxUsmYCe\"}}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5duAFDxE4sCnRX71Wo6zeCpC9C3djE\"}}}, :path->url {\"notebooks/lectures/genlite.clj\" \"notebooks/lectures/genlite.html\", \"notebooks/lectures/smc.clj\" \"notebooks/lectures/smc.html\", \"notebooks/lectures/importance.clj\" \"notebooks/lectures/importance.html\", \"notebooks/lectures/inference.clj\" \"notebooks/lectures/inference.html\", \"notebooks/lectures/simulation.clj\" \"notebooks/lectures/simulation.html\", \"notebooks/lectures/mcmc.clj\" \"notebooks/lectures/mcmc.html\", \"notebooks/lectures/face.clj\" \"notebooks/lectures/face.html\", \"file:/Users/sritchie/.gitlibs/libs/io.github.nextjournal/clerk/d80187013d7b7b96db3d8b114b8d99f687170668/src/nextjournal/clerk/index.clj\" \"\"}, :current-path \"notebooks/lectures/inference.clj\", :resource->url {\"/js/viewer.js\" \"https://cas.clerk.garden/tree/8VxCcd2nQqrhPLVttyyM5Rnv8qMYcjeSEjgJnhZTvCgVhmgsNWWeusxmVkfX9ajrXmFqQEdVmtdHSoCdHLG2XTsXXB/.clerk/shadow-cljs/main.js\"}, :index \"file:/Users/sritchie/.gitlibs/libs/io.github.nextjournal/clerk/d80187013d7b7b96db3d8b114b8d99f687170668/src/nextjournal/clerk/index.clj\"}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
viewer.init(viewer.read_string(state))
</script></body></html>